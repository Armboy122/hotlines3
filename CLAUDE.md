# HotlineS3 - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢ Next.js 15 (App Router) + Elysia Backend + Prisma ORM + PostgreSQL

**‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å:**
- üì± Progressive Web App (PWA) - ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏î‡πâ
- üéØ Responsive Design - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
- üóÑÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (Master Data)
- üìã ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (Task Daily)
- üìä Dashboard ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- üì∏ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏û‡∏£‡πâ‡∏≠‡∏° GPS
- üó∫Ô∏è ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà

## ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

### Frontend
- **Framework**: Next.js 15.4.6 (App Router, React 19, TypeScript 5)
- **Styling**: Tailwind CSS 4
- **UI Components**: Radix UI, Lucide React
- **State Management**: TanStack Query (React Query)
- **Forms**: React Hook Form
- **Maps**: Leaflet, React Leaflet
- **PDF Generation**: jsPDF + jsPDF-AutoTable
- **Date**: date-fns, react-day-picker

### Backend
- **API Framework**: Elysia 1.4.16 (Bun-first web framework)
- **ORM**: Prisma 6.14.0
- **Database**: PostgreSQL (Neon/Supabase/Railway)
- **File Upload**: AWS S3 (@aws-sdk/client-s3)
- **CORS**: @elysiajs/cors

### Package Manager
- **Bun** (bun.lock ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
- ‡πÅ‡∏°‡πâ package.json ‡∏à‡∏∞‡∏£‡∏∞‡∏ö‡∏∏ `packageManager: yarn` ‡πÅ‡∏ï‡πà‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡πÉ‡∏ä‡πâ Bun ‡∏à‡∏£‡∏¥‡∏á

---

## ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```
hotline/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma          # Database schema
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # Database migrations
‚îÇ
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ manifest.json          # PWA manifest
‚îÇ   ‚îú‚îÄ‚îÄ sw.js                  # Service worker
‚îÇ   ‚îú‚îÄ‚îÄ icons/                 # PWA icons
‚îÇ   ‚îî‚îÄ‚îÄ fonts/                 # Custom fonts
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                   # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/            # Admin pages
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/    # Dashboard ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feeders/      # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stations/     # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peas/         # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ operation-centers/  # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏à‡∏∏‡∏î‡∏£‡∏ß‡∏°‡∏á‡∏≤‡∏ô
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-types/    # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-details/  # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ task-daily/   # ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ list/             # ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx        # Root layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api/[[...slugs]]/route.ts  # Elysia API handler
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/               # Base UI components (shadcn/ui)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/            # Form components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/        # Dashboard components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ navbar.tsx        # Navigation bar
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ theme-provider.tsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ task-daily/       # Task Daily feature modules
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ components/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ actions/          # Server Actions
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feeder.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ station.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pea.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ operation-center.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-type.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-detail.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ task-daily.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ team.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts         # Prisma client singleton
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts          # Utilities (cn, etc.)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useUpload.ts      # S3 upload hook
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ server/               # Elysia Backend
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ elysia.ts        # Main Elysia app
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/          # API routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ upload.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ feeders.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stations.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peas.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ operation-centers.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-types.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ job-details.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ teams.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/        # Business logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories/    # Data access layer
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts           # API response types
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ form.ts          # Form types
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ query-types.ts   # React Query types
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ task-daily.ts    # Task Daily types
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ generated/
‚îÇ       ‚îî‚îÄ‚îÄ prisma/          # Generated Prisma Client
‚îÇ
‚îú‚îÄ‚îÄ .env                     # Environment variables (local)
‚îú‚îÄ‚îÄ .env.production          # Production env vars
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ bun.lock                 # Bun lockfile
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ tailwind.config.ts
‚îú‚îÄ‚îÄ next.config.ts
‚îî‚îÄ‚îÄ vercel.json              # Vercel config
```

---

## Elysia Backend Architecture

### ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Elysia ‡πÉ‡∏ô Next.js

‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ **Elysia** ‡πÄ‡∏õ‡πá‡∏ô API framework ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô Next.js Route Handler:

```typescript
// src/app/api/[[...slugs]]/route.ts
import { app } from '@/server/elysia'

export const GET = app.handle
export const POST = app.handle
export const PUT = app.handle
export const DELETE = app.handle
export const PATCH = app.handle
```

### Elysia App Structure

```typescript
// src/server/elysia.ts
import { Elysia } from 'elysia'
import { cors } from '@elysiajs/cors'

export const app = new Elysia({ prefix: '/api' })
    .use(cors())
    .get('/health', () => ({ status: 'ok' }))
    .use(dashboardRoutes)
    .use(tasksRoutes)
    .use(uploadRoutes)
    .use(feedersRoutes)
    // ... other routes

export type App = typeof app
```

### Type-Safe API Client

**Elysia ‡∏°‡∏µ Type Safety ‡πÅ‡∏ö‡∏ö End-to-End** ‡∏ã‡∏∂‡πà‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ export type ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô frontend ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢:

```typescript
// Export type from backend
export type App = typeof app

// Use in frontend with edenTreaty (optional)
import { edenTreaty } from '@elysiajs/eden'
import type { App } from '@/server/elysia'

const client = edenTreaty<App>('http://localhost:3000')
const response = await client.api.feeders.get()
```

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Route Structure:**

```typescript
// src/server/routes/feeders.ts
import { Elysia, t } from 'elysia'
import { prisma } from '@/lib/prisma'

export const feedersRoutes = new Elysia({ prefix: '/feeders' })
    .get('/', async () => {
        const feeders = await prisma.feeder.findMany({
            include: { station: { include: { operationCenter: true } } }
        })
        return { success: true, data: feeders }
    })
    .get('/:id', async ({ params, set }) => {
        const feeder = await prisma.feeder.findUnique({
            where: { id: BigInt(params.id) }
        })
        if (!feeder) {
            set.status = 404
            return { success: false, error: 'Not found' }
        }
        return { success: true, data: feeder }
    })
    .post('/', async ({ body }) => {
        const feeder = await prisma.feeder.create({ data: body })
        return { success: true, data: feeder }
    }, {
        body: t.Object({
            code: t.String(),
            stationId: t.String()
        })
    })
```

### API Endpoints

**Base URL**: `/api`

#### Master Data APIs
- `GET /api/feeders` - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- `GET /api/feeders/:id` - ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏° ID
- `POST /api/feeders` - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
- `PUT /api/feeders/:id` - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå
- `DELETE /api/feeders/:id` - ‡∏•‡∏ö‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå

*‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö:*
- `/api/stations` - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ
- `/api/peas` - ‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤
- `/api/operation-centers` - ‡∏à‡∏∏‡∏î‡∏£‡∏ß‡∏°‡∏á‡∏≤‡∏ô
- `/api/job-types` - ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô
- `/api/job-details` - ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô
- `/api/teams` - ‡∏ó‡∏µ‡∏°

#### Task Daily APIs
- `GET /api/tasks` - ‡∏î‡∏∂‡∏á‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö filters)
- `GET /api/tasks/:id` - ‡∏î‡∏∂‡∏á‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏° ID
- `POST /api/tasks` - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
- `PUT /api/tasks/:id` - ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏á‡∏≤‡∏ô
- `DELETE /api/tasks/:id` - ‡∏•‡∏ö‡∏á‡∏≤‡∏ô

#### Upload API
- `POST /api/upload` - ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ S3

#### Dashboard API
- `GET /api/dashboard/stats` - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ dashboard
- `GET /api/dashboard/team-performance` - ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡∏°
- `GET /api/dashboard/job-distribution` - ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏á‡∏≤‡∏ô

---

## Database Schema (Prisma)

### Core Models

```prisma
// ‡∏à‡∏∏‡∏î‡∏£‡∏ß‡∏°‡∏á‡∏≤‡∏ô (Operation Center)
model OperationCenter {
  id       BigInt   @id @default(autoincrement())
  name     String
  peas     Pea[]
  stations Station[]
}

// ‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (PEA)
model Pea {
  id              BigInt @id @default(autoincrement())
  shortname       String
  fullname        String
  operationId     BigInt
  operationCenter OperationCenter @relation(...)
}

// ‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ (Station)
model Station {
  id              BigInt @id @default(autoincrement())
  name            String
  codeName        String @unique
  operationId     BigInt
  operationCenter OperationCenter @relation(...)
  feeders         Feeder[]
}

// ‡∏ü‡∏µ‡∏î‡πÄ‡∏î‡∏≠‡∏£‡πå (Feeder)
model Feeder {
  id        BigInt @id @default(autoincrement())
  code      String @unique
  stationId BigInt
  station   Station @relation(...)
  tasks     TaskDaily[]
}

// ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô (Job Type)
model JobType {
  id         BigInt @id @default(autoincrement())
  name       String @unique
  tasks      TaskDaily[]
  jobDetails JobDetail[]
}

// ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô (Job Detail)
model JobDetail {
  id        BigInt @id @default(autoincrement())
  name      String @unique
  jobTypeId BigInt?
  jobType   JobType? @relation(...)
  tasks     TaskDaily[]
}

// ‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (Task Daily)
model TaskDaily {
  id          BigInt   @id @default(autoincrement())
  workDate    DateTime @db.Date
  teamId      BigInt
  jobTypeId   BigInt
  jobDetailId BigInt
  detail      String?
  feederId    BigInt?
  numPole     String?
  deviceCode  String?
  urlsBefore  String[]    // Array of image URLs
  urlsAfter   String[]    // Array of image URLs
  latitude    Decimal?    @db.Decimal(9, 6)
  longitude   Decimal?    @db.Decimal(9, 6)

  team        Team        @relation(...)
  jobType     JobType     @relation(...)
  jobDetail   JobDetail   @relation(...)
  feeder      Feeder?     @relation(...)

  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
  deletedAt   DateTime?
}

// ‡∏ó‡∏µ‡∏° (Team)
model Team {
  id    BigInt @id @default(autoincrement())
  name  String
  tasks TaskDaily[]
}
```

### ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Prisma

```bash
# Generate Prisma Client
bun prisma generate

# Create migration
bun prisma migrate dev --name migration_name

# Apply migrations (production)
bun prisma migrate deploy

# Open Prisma Studio
bun prisma studio

# Reset database (‡∏£‡∏∞‡∏ß‡∏±‡∏á: ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
bun prisma migrate reset
```

---

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô

### ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
- **Bun** >= 1.0 (‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: `curl -fsSL https://bun.sh/install | bash`)
- **PostgreSQL** database
- **AWS S3** bucket (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ)

### 1. Clone ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies

```bash
git clone <repository-url>
cd hotline
bun install
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env`:

```bash
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/hotline"

# AWS S3
AWS_REGION="ap-southeast-1"
AWS_ACCESS_KEY_ID="your-access-key"
AWS_SECRET_ACCESS_KEY="your-secret-key"
AWS_S3_BUCKET_NAME="your-bucket-name"

# Next.js
NEXT_PUBLIC_API_URL="http://localhost:3000"
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Database

```bash
# ‡∏£‡∏±‡∏ô migrations
bun prisma migrate dev

# Generate Prisma Client
bun prisma generate

# (Optional) Seed database
bun prisma db seed
```

### 4. ‡∏£‡∏±‡∏ô Development Server

```bash
bun run dev
```

‡πÄ‡∏õ‡∏¥‡∏î [http://localhost:3000](http://localhost:3000)

### 5. ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÜ

```bash
# Build for production
bun run build

# Start production server
bun run start

# Lint code
bun run lint

# Prisma Studio
bun prisma studio
```

---

## ‡∏Å‡∏≤‡∏£ Deploy

### Deploy ‡∏ö‡∏ô Vercel

#### 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Database
- ‡∏™‡∏£‡πâ‡∏≤‡∏á PostgreSQL database ‡∏ö‡∏ô **Neon**, **Supabase**, ‡∏´‡∏£‡∏∑‡∏≠ **Railway**
- ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `DATABASE_URL`

#### 2. Deploy ‡πÑ‡∏õ Vercel

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Vercel CLI
bun install -g vercel

# Login
vercel login

# Deploy
vercel
```

#### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

‡πÉ‡∏ô Vercel Dashboard > Settings > Environment Variables:
```
DATABASE_URL=postgresql://...
AWS_REGION=ap-southeast-1
AWS_ACCESS_KEY_ID=...
AWS_SECRET_ACCESS_KEY=...
AWS_S3_BUCKET_NAME=...
NEXT_PUBLIC_API_URL=https://your-app.vercel.app
```

#### 4. ‡∏£‡∏±‡∏ô Migrations

```bash
# Deploy migrations to production
bunx prisma migrate deploy
```

#### 5. Deploy Production

```bash
vercel --prod
```

### ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ CORS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö S3

‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ S3 direct upload ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ CORS ‡πÉ‡∏ô S3 bucket:

```json
[
  {
    "AllowedHeaders": ["*"],
    "AllowedMethods": ["GET", "PUT", "POST", "DELETE"],
    "AllowedOrigins": ["https://your-app.vercel.app"],
    "ExposeHeaders": ["ETag"]
  }
]
```

---

## PWA Features

‡πÅ‡∏≠‡∏õ‡∏ô‡∏µ‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Progressive Web App:

### ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ‡πÉ‡∏ô‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
2. ‡∏Å‡∏î "Add to Home Screen" ‡∏´‡∏£‡∏∑‡∏≠ "‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á"
3. ‡πÅ‡∏≠‡∏õ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô native app

### Service Worker
- Cache static assets
- Offline fallback
- ‡∏î‡∏π: `public/sw.js`

### Manifest
- ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏µ theme
- ‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏õ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
- ‡∏î‡∏π: `public/manifest.json`

---

## ‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### ‡πÄ‡∏û‡∏¥‡πà‡∏° Master Data ‡πÉ‡∏´‡∏°‡πà

**1. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Prisma Schema**
```prisma
// prisma/schema.prisma
model NewMaster {
  id   BigInt @id @default(autoincrement())
  name String @unique
}
```

**2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Migration**
```bash
bun prisma migrate dev --name add_new_master
```

**3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Elysia Routes**
```typescript
// src/server/routes/new-master.ts
import { Elysia, t } from 'elysia'
import { prisma } from '@/lib/prisma'

export const newMasterRoutes = new Elysia({ prefix: '/new-master' })
    .get('/', async () => {
        const data = await prisma.newMaster.findMany()
        return { success: true, data }
    })
    .post('/', async ({ body }) => {
        const data = await prisma.newMaster.create({ data: body })
        return { success: true, data }
    }, {
        body: t.Object({ name: t.String() })
    })
```

**4. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô Elysia App**
```typescript
// src/server/elysia.ts
import { newMasterRoutes } from './routes/new-master'

export const app = new Elysia({ prefix: '/api' })
    .use(newMasterRoutes)
    // ...
```

**5. ‡∏™‡∏£‡πâ‡∏≤‡∏á Server Actions**
```typescript
// src/lib/actions/new-master.ts
'use server'

export async function getNewMasters() {
  const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/new-master`)
  return res.json()
}
```

**6. ‡∏™‡∏£‡πâ‡∏≤‡∏á UI**
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ô `src/app/admin/new-master/page.tsx`
- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏ô `src/components/forms/new-master-form.tsx`

### ‡πÄ‡∏û‡∏¥‡πà‡∏° Field ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô TaskDaily

**1. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Prisma Schema**
```prisma
model TaskDaily {
  // existing fields...
  newField String?
}
```

**2. Migration**
```bash
bun prisma migrate dev --name add_new_field
```

**3. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Types**
```typescript
// src/types/task-daily.ts
export interface TaskDailyFormData {
  // existing fields...
  newField?: string
}
```

**4. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°**
- ‡πÄ‡∏û‡∏¥‡πà‡∏° field ‡πÉ‡∏ô `src/features/task-daily/components/task-daily-form.tsx`

### ‡πÉ‡∏ä‡πâ Elysia Types ‡πÉ‡∏ô Frontend

```typescript
// Backend: export type
export const app = new Elysia()
    .get('/users/:id', ({ params }) => {
        return { id: params.id, name: 'John' }
    })

export type App = typeof app

// Frontend: infer types
import type { App } from '@/server/elysia'
import { edenTreaty } from '@elysiajs/eden'

const client = edenTreaty<App>('http://localhost:3000')

// TypeScript ‡∏à‡∏∞‡∏£‡∏π‡πâ response type ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
const { data } = await client.api.users({ id: '1' }).get()
// data: { id: string; name: string }
```

---

## Common Issues ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ

### 1. Prisma Generate ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
```bash
# ‡∏•‡∏ö node_modules ‡πÅ‡∏•‡∏∞ reinstall
rm -rf node_modules bun.lock
bun install
bun prisma generate
```

### 2. Database Connection Error
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `DATABASE_URL` ‡πÉ‡∏ô `.env`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ PostgreSQL ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö firewall/network

### 3. BigInt Serialization Error
```typescript
// Serialize BigInt before returning
JSON.parse(JSON.stringify(data, (key, value) =>
    typeof value === 'bigint' ? value.toString() : value
))
```

### 4. Elysia Type Import Error
```typescript
// ‡πÉ‡∏ä‡πâ type import
import type { App } from '@/server/elysia'
```

### 5. S3 Upload Error
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö AWS credentials
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö S3 CORS configuration
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö bucket permissions

### 6. Build Error: "Module not found"
```bash
# Clear Next.js cache
rm -rf .next
bun run build
```

### 7. Lint Warnings: `any` types
- ‡πÉ‡∏ä‡πâ proper types ‡∏à‡∏≤‡∏Å Prisma Client
- Import types ‡∏à‡∏≤‡∏Å `@/types/api`
- ‡πÉ‡∏ä‡πâ Elysia schema validation (`t.Object`, `t.String`, etc.)

---

## Best Practices

### 1. Type Safety
- **‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ `any`** ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ proper types
- ‡πÉ‡∏ä‡πâ Prisma types: `Prisma.FeederCreateInput`, etc.
- ‡πÉ‡∏ä‡πâ Elysia validation schema

### 2. Error Handling
```typescript
.get('/', async ({ set }) => {
    try {
        const data = await prisma.model.findMany()
        return { success: true, data }
    } catch (error) {
        set.status = 500
        return { success: false, error: 'Internal server error' }
    }
})
```

### 3. API Response Format
```typescript
// Success
{ success: true, data: any }

// Error
{ success: false, error: string }
```

### 4. Server Actions
- ‡πÉ‡∏™‡πà `'use server'` ‡∏Ç‡πâ‡∏≤‡∏á‡∏ö‡∏ô
- ‡πÉ‡∏ä‡πâ `revalidatePath()` ‡∏´‡∏•‡∏±‡∏á mutation
- Handle errors properly

### 5. React Query
```typescript
const { data, isLoading } = useQuery({
    queryKey: ['feeders'],
    queryFn: getFeeders
})
```

### 6. Form Handling
- ‡πÉ‡∏ä‡πâ React Hook Form + Zod validation
- ‡πÅ‡∏™‡∏î‡∏á error messages
- Disable submit ‡∏Ç‡∏ì‡∏∞ loading

---

## Performance Optimization

### 1. Prisma Query Optimization
```typescript
// ‡πÉ‡∏ä‡πâ select ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ fields ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
const feeders = await prisma.feeder.findMany({
    select: {
        id: true,
        code: true,
        station: { select: { name: true } }
    }
})

// ‡πÉ‡∏ä‡πâ include ‡∏Å‡∏±‡∏ö relation ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
```

### 2. Next.js Optimization
- ‡πÉ‡∏ä‡πâ `loading.tsx` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö loading states
- ‡πÉ‡∏ä‡πâ `error.tsx` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö error boundaries
- ‡πÉ‡∏ä‡πâ dynamic imports ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö heavy components

### 3. React Query Caching
```typescript
const queryClient = new QueryClient({
    defaultOptions: {
        queries: {
            staleTime: 5 * 60 * 1000, // 5 minutes
            cacheTime: 10 * 60 * 1000, // 10 minutes
        }
    }
})
```

---

## Testing

### Unit Tests (Future)
```bash
bun test
```

### API Testing
```bash
# ‡πÉ‡∏ä‡πâ Postman, Insomnia, ‡∏´‡∏£‡∏∑‡∏≠ curl
curl http://localhost:3000/api/health
```

### Database Testing
```bash
# ‡πÉ‡∏ä‡πâ Prisma Studio
bun prisma studio
```

---

## Contributing

### Commit Convention
```
feat: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
fix: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç bug
refactor: ‡∏õ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î
docs: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï documentation
style: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç formatting
test: ‡πÄ‡∏û‡∏¥‡πà‡∏° tests
chore: ‡∏á‡∏≤‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ (dependencies, config)
```

### Branch Strategy
```
main          - Production
develop       - Development
feature/*     - Features
bugfix/*      - Bug fixes
```

---

## Resources

### Documentation
- [Next.js 15](https://nextjs.org/docs)
- [Elysia](https://elysiajs.com)
- [Prisma](https://www.prisma.io/docs)
- [Bun](https://bun.sh/docs)
- [Tailwind CSS 4](https://tailwindcss.com/docs)
- [TanStack Query](https://tanstack.com/query)

### Tools
- [Prisma Studio](https://www.prisma.io/studio) - Database GUI
- [Vercel](https://vercel.com) - Hosting
- [Neon](https://neon.tech) - Serverless Postgres

---

## License

MIT License

---

## Changelog

### v0.1.0 (Current)
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (Master Data)
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô (Task Daily)
- Dashboard ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û + GPS
- PWA support
- Elysia backend integration

---

**‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢**: ‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤ HotlineS3
**‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î**: 2025-01-21
